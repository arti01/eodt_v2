<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets" 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                template="/templates/templateGPF.xhtml"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:p="http://primefaces.org/ui">


    <ui:define name="content">
        <h:form id="center">
            <p:fieldset id="formWprow" collapsed="#{AdmNewsMg.obiekt.id==null}" toggleable="true" legend="Dodaj news (zwiń/rozwiń)" 
                        style="">
                <p:panelGrid columns="3" id="form" columnClasses="column1, column2">
                    <p:outputLabel for="nazwa" value="Tytuł"/>
                    <p:inputText id="nazwa" value="#{AdmNewsMg.obiekt.nazwa}" size="90"/>
                    <p:message for="nazwa"/>

                    <p:outputLabel for="prior" value="Priorytet"/>
                    <p:inputSwitch id="prior" value="#{AdmNewsMg.obiekt.priorytet}" onLabel="TAK" offLabel="NIE"/>
                    <p:message for="prior"/>

                    <p:outputLabel for="data" value="Data"/>
                    <p:calendar id="data" value="#{AdmNewsMg.obiekt.dataDodania}" pattern="yyyy-MM-dd" locale="pl" showOn="button"/>
                    <p:message for="data"/>

                    <p:outputLabel for="tresc" value="Treść - wpisz prostą treść lub po zapisaniu skorzystaj z edytora"/>
                    <p:inputTextarea id="tresc" value="#{AdmNewsMg.obiekt.opis}" rows="20" cols="80"/>
                    <p:message for="tresc"/>

                </p:panelGrid>
                <center>
                    <p:message for="dodaj" styleClass="error"/>
                    <p:commandButton id="dodaj" value="Dodaj" action="#{AdmNewsMg.dodaj}" update=":infoForm:messages, :center:table, formWprow" process="formWprow"/>
                </center>
            </p:fieldset>

            <p:dataTable id="table" value="#{AdmNewsMg.lista}" var="item" paginator="true" rowsPerPageTemplate="20, 50, 100" rows="20" sortBy="#{item.dataDodania}" sortOrder="descending"
                         widgetVar="tableV" emptyMessage="brak danych" style="text-align: center" editable="true">
                <p:ajax event="rowEdit" listener="#{AdmNewsMg.editList}" update=":infoForm:messages"/>
                <p:column headerText="Data dodania">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{item.dataDodania}">
                                <f:convertDateTime pattern="yyyy-MM-dd" locale="pl" timeZone="CET"/>
                            </h:outputText>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText id="modelInputData" value="#{item.dataDodania}" style="width:100%">
                                <f:convertDateTime pattern="yyyy-MM-dd" locale="pl" timeZone="CET"/>
                            </p:inputText>
                            <p:message for="modelInputData"/>
                        </f:facet>
                    </p:cellEditor>
                    <p:message for="table"/>
                </p:column>
                <p:column headerText="Tytuł">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{item.nazwa}"/>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText id="modelInputNazwa" value="#{item.nazwa}" style="width:100%"/>
                            <p:message for="modelInputNazwa"/>
                        </f:facet>
                    </p:cellEditor>
                    <p:message for="table"/>
                </p:column>

                <p:column headerText="Priorytet">
                    <p:cellEditor>
                        <f:facet name="output">
                            <p:inputSwitch value="#{item.priorytet}" onLabel="TAK" offLabel="NIE" disabled="true"/>
                        </f:facet>
                        <f:facet name="input">
                            <p:selectOneButton value="#{item.priorytet}">
                                <f:selectItem itemLabel="TAK" itemValue="true" />
                                <f:selectItem itemLabel="NIE" itemValue="false" />
                            </p:selectOneButton>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column style="width: 35px" headerText="Edycja">
                    <p:rowEditor editTitle="edytuj"/>
                </p:column>

                <p:column style="width: 70px" headerText="Edycja treści">
                    <p:commandButton update=":center:newsDetail" oncomplete="PF('newsOP').show('#{component.clientId}')" icon="ui-icon-search" title="View" process="@this">
                        <f:setPropertyActionListener value="#{item}" target="#{AdmNewsMg.obiekt}"/>
                    </p:commandButton>
                </p:column>

                <p:column style="width: 30px" headerText="usuń">
                    <p:commandButton title="usuń" update="table" icon="ui-icon-trash" action="#{AdmNewsMg.usun}" process="@this"
                                     style="font-weight: lighter; font-size: smaller;">
                        <f:setPropertyActionListener value="#{item}" target="#{AdmNewsMg.obiekt}"/>
                        <p:confirm header="Potwierdzenie" message="Czy jesteś pewny?" icon="ui-icon-alert" />
                    </p:commandButton>
                </p:column>
            </p:dataTable>

            <style>
                .ui-editor{
                    background: white;
                </style>

                <p:overlayPanel id="newsOP" widgetVar="newsOP" showEffect="fade" hideEffect="fade" dismissable="false" showCloseIcon="false" style="background: white;">
                    <p:outputPanel id="newsDetail" style="text-align:center; background-color: white;">
                        <p:editor widgetVar="editor1" value="#{AdmNewsMg.obiekt.opis}"/>
                    </p:outputPanel>
                    <p:commandButton value="zapisz" action="#{AdmNewsMg.edytujList}" process=":center:newsOP" oncomplete="PF('newsOP').hide()"/>
                </p:overlayPanel>

            </h:form>
        </ui:define>
    </ui:composition>

