<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets" 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                template="/templates/templateGPF.xhtml"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="tytul">
        <h3>Lista użytkowników</h3>
    </ui:define>

    <ui:define name="content">
        <h:form id="center">
            <p:defaultCommand target="dummy"/>
            <p:commandButton id="dummy" process="@none" global="false" style="display:none;"/>
            <p:outputPanel id="listPanel">
                <p:dataTable value="#{UsersM.dataModelPF}" var="strukt" id="table" editable="true" emptyMessage="brak rekordów">
                    <ui:param name="property" value="fullname" />
                    <ui:param name="propSort" value="userId.fullname" />
                    <p:column headerText="Imię i nazwisko" style="width:60%" >

                        <h:outputText id="nameE" value="#{strukt.userId.fullname}"/>
                        <h:panelGrid columns="2" style="width:100%;border-spacing:0px;">
                            <h:outputLabel for="email" value="eMail: "/>
                            <h:outputText id="email" value="#{strukt.userId.adrEmail}"/>

                            <h:outputLabel for="kierownik" value="Czy kierownik?: "/>
                            <h:selectBooleanCheckbox id="kierownik" value="#{strukt.stKier}" readonly="true"/>

                            <h:outputLabel for="przelozonyK" value="Przełożony: "/>
                            <h:outputText id="przelozonyK" value="#{strukt.szefId.userId.fullname}"/>

                            <h:outputLabel for="sec_user_id" value="zastępuje go:"/>
                            <h:outputText id="sec_user_id" value="#{strukt.secUserId.fullname}"/>

                            <h:outputLabel for="sec_user_id_jest" value="jest zastępcą dla:"/>
                            <h:panelGroup id="sec_user_id_jest">
                                <ul>
                                    <ui:repeat value="#{strukt.userId.strukturaSec}" var="str">
                                        <li>
                                            #{str.userId.fullname}
                                        </li>                                         
                                    </ui:repeat>
                                </ul>
                            </h:panelGroup>

                            <h:outputLabel for="przyjwnioski" value="Czy uprawniony do przyjmowania wniosków innych osób?: "/>
                            <h:selectBooleanCheckbox id="przyjwnioski" value="#{strukt.przyjmowanieWnioskow}" readonly="true"/>

                            <h:outputLabel for="musZast" value="Czy musi mieć ustawionego zastępcę?: "/>
                            <h:selectBooleanCheckbox id="musZast" value="#{strukt.musZast}" readonly="true"/>

                            <h:outputLabel for="extid" value="Zewnętrzny identyfikator:"/>
                            <h:outputText id="extid" value="#{strukt.userId.extId}"/>

                            <h:outputLabel for="extraemail" value="Dodatkowe emaile:"/>
                            <h:outputText id="extraemail" value="#{strukt.extraemail}"/>

                            <h:outputLabel for="roles" value="uprawnienia:"/>
                            <ui:repeat id="roles" value="#{strukt.userId.role}" var="rola">
                                #{rola.opis},
                            </ui:repeat>
                        </h:panelGrid>
                        <h:panelGrid columns="1" rendered="#{fn:length(strukt.bezpPodWidoczni)>0}">
                            <br/>
                            Bezpośredni podwładni:
                            <ul>
                                <ui:repeat value="#{strukt.bezpPodWidoczni}" var="podwl">
                                    <li>#{podwl.userId.fullname}</li>
                                </ui:repeat>
                            </ul>
                        </h:panelGrid>
                    </p:column>
                    <ui:param name="property" value="nazwa" />
                    <p:column headerText="Dział (symbol)" id="colKier" style="width:30%; text-align: center" >
                        <h:outputText id="dzialE" value="#{strukt.dzialId.nazwa}"/>
                        <br/>
                        <h:outputText id="dzialES" value="(#{strukt.dzialId.symbol})"/>
                    </p:column>

                    <p:column headerText="akcje" style="width:13%">
                        <h:commandLink id="kalendarz" value="[Rezerwacje]"  action="#{RezerMojKalMg.listObcy()}" immediate="true">
                            <f:setPropertyActionListener target="#{RezerMojKalMg.uzyt}" value="#{strukt.userId}"/>
                        </h:commandLink>
                    </p:column>
                </p:dataTable>
            </p:outputPanel>
        </h:form>
    </ui:define>

</ui:composition>
